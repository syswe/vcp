<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <title>Video Compression</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      .upload-container {
        max-width: 800px;
        margin: 50px auto;
        padding: 20px;
      }
      .results-container {
        margin-top: 30px;
      }
      .compression-card {
        margin-bottom: 20px;
      }
      .stat-label {
        font-weight: bold;
        color: #666;
      }
      .file-size {
        font-family: monospace;
      }
    </style>
  </head>
  <body class="bg-light">
    <div class="container upload-container">
      <h2 class="text-center mb-4">Video Compression Tool</h2>

      <div th:if="${error}" class="alert alert-danger" role="alert">
        <span th:text="${error}"></span>
      </div>

      <div th:if="${success}" class="alert alert-success" role="alert">
        <span th:text="${success}"></span>
      </div>

      <div class="card">
        <div class="card-body">
          <form
            method="POST"
            action="/upload"
            enctype="multipart/form-data"
            class="mb-3"
          >
            <div class="mb-3">
              <label for="video" class="form-label">Select Video File</label>
              <input
                type="file"
                class="form-control"
                id="video"
                name="video"
                accept="video/*"
                required
              />
            </div>
            <button type="submit" class="btn btn-primary">
              Upload and Process
            </button>
          </form>
        </div>
      </div>

      <!-- Compression Results -->
      <div th:if="${results}" class="results-container">
        <h3 class="mb-4">Compression Results</h3>
        <div class="row">
          <div th:each="result : ${results}" class="col-md-6">
            <div class="card compression-card">
              <div class="card-header">
                <h5
                  class="card-title mb-0"
                  th:text="${result.resolution + ' Version'}"
                >
                  Resolution
                </h5>
              </div>
              <div class="card-body">
                <div class="mb-2">
                  <span class="stat-label">Original Size:</span>
                  <span
                    class="file-size"
                    th:text="${#numbers.formatDecimal(result.originalSize/1048576.0, 1, 3) + ' MB'}"
                    >Size</span
                  >
                </div>
                <div class="mb-2">
                  <span class="stat-label">Compressed Size:</span>
                  <span
                    class="file-size"
                    th:text="${#numbers.formatDecimal(result.compressedSize/1048576.0, 1, 3) + ' MB'}"
                    >Size</span
                  >
                </div>
                <div class="mb-2">
                  <span class="stat-label">Compression Ratio:</span>
                  <span
                    th:text="${#numbers.formatDecimal(result.compressionRatio * 100, 1, 2) + '%'}"
                    >Ratio</span
                  >
                </div>
                <div class="mb-2">
                  <span class="stat-label">Original Resolution:</span>
                  <span th:text="${result.originalResolution}">Resolution</span>
                </div>
                <div class="mb-2">
                  <span class="stat-label">Bitrate:</span>
                  <span
                    th:text="${#numbers.formatDecimal(result.bitrate/1000000.0, 1, 3) + ' Mbps'}"
                    >Bitrate</span
                  >
                </div>
                <div class="mb-2">
                  <span class="stat-label">Duration:</span>
                  <span th:text="${result.duration + ' seconds'}"
                    >Duration</span
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
